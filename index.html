<!DOCTYPE html>
<html lang="kk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Hybrid Geo Map</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <style>
        body, html { margin: 0; padding: 0; height: 100%; background: #000; }
        #map { width: 100%; height: 100vh; }
        .info-panel {
            position: absolute; top: 15px; left: 50%; transform: translateX(-50%);
            z-index: 1000; background: rgba(0,0,0,0.85); color: white;
            padding: 10px 20px; border-radius: 30px; font-family: sans-serif;
            font-size: 14px; border: 1px solid #0088cc; white-space: nowrap;
        }
    </style>
</head>
<body>
    <div class="info-panel" id="info">üåç –ï–ª–¥—ñ –Ω–µ–º–µ—Å–µ –Ω—ã—Å–∞–Ω–¥—ã —Ç–∞“£–¥–∞“£—ã–∑</div>
    <div id="map"></div>

    <script>
        let tg = window.Telegram.WebApp;
        tg.expand();

        var map = L.map('map', { zoomControl: false }).setView([48, 67], 3);

        // 1. –¢”®–ú–ï–ù–ì–Ü “ö–ê–ë–ê–¢: Esri –°–ø—É—Ç–Ω–∏–∫—Ç—ñ–∫ —Å—É—Ä–µ—Ç—Ç–µ—Ä—ñ (–ù—ã—Å–∞–Ω–¥–∞—Ä–¥—ã —Ç–∞–Ω—É “Ø—à—ñ–Ω)
        L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}').addTo(map);

        // 2. –ñ–û“í–ê–†“í–´ “ö–ê–ë–ê–¢: OpenStreetMap Labels (“ö–∞–ª–∞ –∞—Ç—Ç–∞—Ä—ã –º–µ–Ω —à–µ–∫–∞—Ä–∞–ª–∞—Ä)
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            opacity: 0.3, // –®–µ–∫–∞—Ä–∞–ª–∞—Ä —Ç—ã–º “õ–∞—Ç—Ç—ã –∫”©—Ä—ñ–Ω–±–µ—É—ñ “Ø—à—ñ–Ω –º”©–ª–¥—ñ—Ä–ª—ñ–∫
            pane: 'markerPane' // –°–ø—É—Ç–Ω–∏–∫—Ç—ñ“£ “Ø—Å—Ç—ñ–Ω–¥–µ —Ç“±—Ä—É—ã “Ø—à—ñ–Ω
        }).addTo(map);

        // 3. –ê–ô–ú–ê“ö–¢–ê–†–î–´ –¢–ê–ù–£ (GeoJSON)
        fetch('https://raw.githubusercontent.com/datasets/geo-boundaries-world-110m/master/countries.geojson')
            .then(res => res.json())
            .then(data => {
                L.geoJSON(data, {
                    style: function() {
                        return { color: "#00ffea", weight: 1, fillOpacity: 0.1 };
                    },
                    onEachFeature: function(feature, layer) {
                        layer.on('click', function(e) {
                            let name = feature.properties.name;
                            document.getElementById('info').innerText = `–¢–∞“£–¥–∞–ª–¥—ã: ${name}`;
                            
                            // –ë–æ—Ç“õ–∞ –∂—ñ–±–µ—Ä—É
                            setTimeout(() => {
                                tg.sendData(name);
                            }, 500);
                        });
                        
                        // “Æ—Å—Ç—ñ–Ω–µ –∫–µ–ª–≥–µ–Ω–¥–µ –∂–∞—Ä—ã“õ –±–æ–ª—É (Hover effect)
                        layer.on('mouseover', function() { this.setStyle({ fillOpacity: 0.3 }); });
                        layer.on('mouseout', function() { this.setStyle({ fillOpacity: 0.1 }); });
                    }
                }).addTo(map);
            });
    </script>
</body>
</html>
